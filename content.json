{"meta":{"title":"Ivan's Tech Blog","subtitle":"C++ / Linux / System Programming","description":"记录 C++、Linux、系统方向学习与项目","author":"Ivan-FYF","url":"https://hellonnnnn.github.io","root":"/"},"pages":[{"title":"404","text":"","path":"404/index.html","date":"12-17","excerpt":""},{"title":"search","text":"","path":"search/index.html","date":"12-17","excerpt":""}],"posts":[{"title":"xv6-labs-2020 lab1","text":"����ȷ���ĸ��fork+exec�� Unix&#x2F;Linux������ xv6��ִ�г���ĺ���ģʽ������Ĵ���Ƭ���У�exec���滻��ǰ���̵Ĵ��������ΪĿ�������&#x2F;bin&#x2F;echo������ **exec�������ᴴ���½��� **����ˣ�ʵ��ʹ������Ҫ��ͨ��fork�����ӽ��̣������ӽ����е���exec���� �����ȱ����˸����̣�shell�����������ӽ���ִ���³�����Ҳ�� xv6 shell �ĺ����߼���xv6 shell ִ��echo hello���������̣����Դ��λ�ã��������û��� xv6 shell ������echo helloΪ����������ᵽ��user&#x2F;sh.c�еĹؼ��У�����������̣����� 1��shell ����ѭ���ȴ��û����루main(user&#x2F;sh.c:145)��xv6 �� shell ������һ��������ѭ���У������������£���ӡ��ʾ������$ ��������getcmd������ȡ�û������һ�������echo hello������ʱ shell �Ǹ����̣�����ǰ̨����״̬���ȴ��û������������ 2�������ӽ��̣�fork�����û�����echo hello���س���shell �����fork()ϵͳ���ã�����һ����������ȫ��ͬ���ӽ��̣������̣�shell����fork�᷵���ӽ��̵� PID������ ID����֮�󸸽��̻����wait()��waitpid()����������״̬���ȴ��ӽ���ִ����ϡ��ӽ��̣�fork�᷵�� 0���ӽ��̻����ִ�к�����������߼���������runcmd�����ؼ���fork�� �����ơ� ���� ���´��������ӽ���ӵ�к͸�������ȫ��ͬ���ڴ�ռ䡢��������ݣ�ֱ��ִ��exec�Żᱻ�滻������ 3���ӽ��̵���runcmd(user&#x2F;sh.c:58)���������ӽ��̻Ὣ�û������echo hello����Ϊ����Ͳ��������echo��������hello����Ȼ�����runcmd����ִ��ʵ���߼�����������·����runcmd���ҵ�echo��Ӧ�Ŀ�ִ���ļ�·������&#x2F;bin&#x2F;echo���������������argv������������Ĵ���Ƭ��һ���������ʽ���£�char* argv[3];argv[0] &#x3D; “echo”; &#x2F;&#x2F; ��һ������ͨ���ǳ������������������ԣ����淶Ҫ����argv[1] &#x3D; “hello”; &#x2F;&#x2F; ʵ�ʵĲ���argv[2] &#x3D; 0; &#x2F;&#x2F; ����������NULL��β����ʶ������������ 4���ӽ��̵���exec(user&#x2F;sh.c:78)�滻�����ӽ��̵���exec(“&#x2F;bin&#x2F;echo”, argv)�������������̵ĺ��ģ�execϵͳ���ûᶪ����ǰ�ӽ��̵Ĵ�������ݣ�����&#x2F;bin&#x2F;echo����Ĵ�������ݵ��ӽ��̵��ڴ�ռ��У�Ȼ���echo�����main������ʼִ�У���������argv��echo hello�������execִ�гɹ����ӽ��̾Ͳ����� shell �ĸ����ˣ����Ǳ����echo����Ľ��̣�֮ǰ��runcmd����Ҳ������ִ�У����printf(“exec error\\n”)���ᱻ��ӡ�������� 5��echo����ִ����ϣ�����exitecho��������hello��Ȼ�����exit()ϵͳ���ã�exit����ֹ�ӽ��̣��ͷ���Դ����֪ͨ�����̣�shell�����ӽ�������ɡ������� 6�������̣�shell����wait�з��أ�������ѭ�����ӽ��̵���exit�󣬸����̣�shell����wait()�᷵�أ��������״̬�������̻������ӽ��̵Ľ�ʬ״̬���ص���ѭ�����ٴδ�ӡ��ʾ�����ȴ��û�������һ��������䣺���execʧ�ܻ����������exec����ʧ�ܣ������Ҳ���&#x2F;bin&#x2F;echo�ļ������ӽ��̲��ᱻ�滻�������ִ�к������룬Ҳ����������е�printf(“exec error\\n”)��Ȼ���ӽ��̻����exit��ֹ��������ͬ�����wait�з��ء�Ϊʲô��������ĵ�һ��Ԫ���ǳ�������argv[0]�������ᵽ ������������Բ��������еĵ�һ��Ԫ�ء���������Ϊ���淶Լ����Unix&#x2F;Linux �ĳ�������淶�У�argv[0]Ĭ���ǳ�������ƣ���·������argv[1]���Ժ����ʵ�ʲ���������������������Щ�����ʹ��argv[0]������ls���������������Ϊll��argv[0]����ll��������Ը���argv[0]�Ĳ�ִͬ�в�ͬ���߼���xv6 �ļ򻯴�����xv6 �еĳ�����echo���Ƚϼ򵥣�������argv[0]��ֻ����argv[1]���Ժ�Ĳ���������Ȼ��ѭ����淶���ܽ��ؼ���ع�xv6 shell �ĺ����߼���ͨ��fork�����ӽ��̣��ӽ�����exec�滻ΪĿ����򣬸�������wait�ȴ��ӽ��̽��������� Unix ϵϵͳִ�г���ľ���ģʽ��echo hello��ִ�����̣�shell ��ѭ���������� �� fork�����ӽ��� �� �ӽ��̽����������argv �� exec����&#x2F;bin&#x2F;echo �� echoִ�в�exit �� ������wait���ز�����ѭ����argv[0]�����ã��� Unix �淶Լ���ĳ����������� xv6 ������������������������ʱ���뱣�����Ҳ���������NULL��β��������̵ı����Ƿ����� �����̴�������fork���� ��������ء���exec������ shell ������Ϊ�����̳������У����ӽ���ר��ִ���û������Ҳ�� shell �����������û�����Ĺؼ���","path":"2025/12/18/xv6-labs-2020-lab1/","date":"12-18","excerpt":"","tags":[]},{"title":"Hello World","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. 我是Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","path":"2025/12/17/hello-world/","date":"12-17","excerpt":"","tags":[]}],"categories":[],"tags":[]}